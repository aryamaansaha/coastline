# API Contract & Data Models

**General Guidelines:**  
All structures generated by the LLM must be compatible with a corresponding Pydantic model ending with the suffix `LLMCreate` (as shown in `backend/app/schemas/`).  
**Note:** Identifiers (`id`, `uuid`, etc.) and similar fields should not be generated by the LLM as they can be assigned by backend logic.


### Activity Object
Each item in a day (Hotel, Meal, Museum) follows this structure.
- The location's latitude and longtidute is going to be obtained from the geocoding service, not from the LLM. 
- Total estimated cost across currencies is something we should sum up using code, not from LLM.
```json
{
  "id": "uuid-string",
  "type": "flight | hotel | activity",
  "time_slot": "10:00 AM",
  "title": "Louvre Museum",
  "description": "World's largest art museum...",
  "activity_suggestion": "Stand in line a little early, spend some time doing X, Y till Z time <could be a few sentences>",
  "location": {
    "name": "Mus√©e du Louvre",
    "lat": 48.8606,
    "lng": 2.3376,
    "address": "Rue de Rivoli, Paris"
  },
  "estimated_cost": 25.00,
  "price_suggestion": "Book in advance/Take a train to this location so it's cheaper/other cost suggestions",
  "currency": "USD",
}
```
### Itinerary Object (The Main Payload)
```json
{
  "trip_id": "uuid-string",
  "trip_title": "3 Days in Paris",
  "budget_limit": 1000,
  "days": [
    {
      "id": "day-uuid-string",
      "day_number": 1,
      "theme": "Art & History",
      "activities": [ ...Array of Activity Objects... ]
    }
  ]
}
```
### Preferences (Travel + User can be fleshed out and persisted to a Knowledge Graph/Database later). I've kept it ultra simple for now (bare minimum)

```json
{
    "destinations": ["Paris"],
    "start_date": <datetime object>,
    "end_date":<datetime object>,
    "budget": 1000,

}
```

# API Endpoints
A. User & Preferences
- POST /api/user/preferences
    - Body: Could be a text string describing preferences as input
    - Action: Persists the Preferences structured data (Logic can be implemented later, for now the preferences get fed to agent)

B. Trip Management
- POST /api/trip/generate (The Long Running Task)
    - Body: Preferences Object
    - Action:
        1. Get user/travel preferences
        2. Trigger LangGraph Agent.
        3. Save result to MongoDB.
        4. Return Itinerary Object.

- GET /api/trip/{trip_id}
    - Returns: Itinerary Object (from MongoDB).

- PUT /api/trip/{trip_id}
    - Body: Itinerary Object (Complete updated JSON).
    - Action: Updates the MongoDB document (used when user drags/drops or deletes items).